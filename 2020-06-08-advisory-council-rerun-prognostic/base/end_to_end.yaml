storage_proto: gs
storage_root: vcm-ml-experiments/2020-06-08-advisory-council-rerun-prognostic
experiment:
  name: $JOBNAME
  unique_id: false
  steps_to_run:
    - baseline_run
    - baseline_run_clean
    - prognostic_run
    - prognostic_run_clean

  steps_config:
    prognostic_run:
      command: python workflows/prognostic_c48_run/orchestrate_submit_job.py
      args:
        restart_data:
          location: $C48_RESTARTS
        ic_timestep: $IC_TIMESTEP
        docker_image: $PROGNOSTIC_RUN_IMAGE
        --prog_config_yml: $CONFIG/prognostic_run.yml
        --allow_fail: ''
        --model_url:
          location: $ML_MODEL

    baseline_run:
      command: python workflows/prognostic_c48_run/orchestrate_submit_job.py
      args:
        restart_data:
          location: $C48_RESTARTS
        ic_timestep: $IC_TIMESTEP
        docker_image: $PROGNOSTIC_RUN_IMAGE
        --prog_config_yml: $CONFIG/prognostic_run.yml
        --diagnostic_ml: ''  # hack for allowing flags in end-to-end orchestrator
        --allow_fail: ''
        --model_url:
          location: $ML_MODEL

    prognostic_run_clean:
      command: python workflows/prognostic_c48_run/post_process.py
      args:
        rundir:
          from: prognostic_run

    baseline_run_clean:
      command: python workflows/prognostic_c48_run/post_process.py
      args:
        rundir:
          from: baseline_run
