plugins:
  source:
    - module: intake_xarray
sources:
  40day_c384_diags_time_avg_may2020:
    description: Time-averaged diagnostics for 40-day nudged simulation at C384 resolution (May 27 2020 SHiELD)
    driver: zarr
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: 'gs://vcm-ml-raw/2020-05-27-40-day-X-SHiELD-simulation-C384-diagnostics/gfsphysics_15min_coarse.zarr/'
      consolidated: True

  40day_c384_diag_atmos_avg_may2020:
    description: Time-averaged atmos diagnostics from the 40-day nudged simulation (May 27 2020 SHiELD)
    driver: zarr
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: 'gs://vcm-ml-raw/2020-05-27-40-day-X-SHiELD-simulation-C384-diagnostics/atmos_15min_coarse_ave.zarr/'
      consolidated: True

  40day_1deg_atmos_15min_may2020:
    description: Instantaneous 8x daily atmospheric diagnostics from the 40 day run on a lat lon grid (May 27 2020 SHiELD)
    driver: zarr
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: 'gs://vcm-ml-raw/2020-05-27-40-day-X-SHiELD-simulation-regridded-diagnostics/atmos_15min_coarse_inst_1_degree.zarr/'
      consolidated: True

  40day_c384_atmos_8xdaily_may2020:
    description: Instantaneous 8x daily atmospheric diagnostics from the 40 day run on a C384 grid (May 27 2020 SHiELD)
    driver: zarr
    metadata:
      grid: c384
      simulation: 40day_may2020
      category: dycore
      variables:
        - PRESctp
        - PRESsfc
        - PRMSL
        - PWAT
        - REFC
        - TB
        - TMP500_300
        - UGRDlowest
        - VGRDlowest
        - VIL
        - VORT200
        - VORT500
        - VORT850
        - VVEL5km
        - h500
        - iw
        - u200
        - v200
        - w500
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-raw/2020-05-27-40-day-X-SHiELD-simulation-C384-diagnostics/atmos_8xdaily_C3072_to_C384.zarr"
      consolidated: True

  40day_c48_gfsphysics_15min_may2020:
    description: 2D physics diagnostics variables from 40-day nudged simulation (May 27 2020 SHiELD), coarsened to C48 resolution and rechunked to 96 15-minute timesteps (1 day) per chunk
    driver: zarr
    metadata:
      grid: c48
      simulation: 40day_may2020
      category: physics
      variables:
        - CPRATEsfc_coarse
        - DCLWRFsfc_coarse
        - DCSWRFsfc_coarse
        - DLWRFsfc_coarse
        - DSWRFsfc_coarse
        - DSWRFtoa_coarse
        - HPBLsfc_coarse
        - LHTFLsfc_coarse
        - PRATEsfc_coarse
        - SHTFLsfc_coarse
        - UCLWRFsfc_coarse
        - UCLWRFtoa_coarse
        - UCSWRFsfc_coarse
        - UCSWRFtoa_coarse
        - UGRD10m_coarse
        - ULWRFsfc_coarse
        - ULWRFtoa_coarse
        - USWRFsfc_coarse
        - USWRFtoa_coarse
        - VGRD10m_coarse
        - int_dq3dt_deep_conv_coarse
        - int_dq3dt_mp_coarse
        - int_dq3dt_pbl_coarse
        - int_dq3dt_shal_conv_coarse
        - int_dt3dt_deep_conv_coarse
        - int_dt3dt_lw_coarse
        - int_dt3dt_mp_coarse
        - int_dt3dt_ogwd_coarse
        - int_dt3dt_pbl_coarse
        - int_dt3dt_shal_conv_coarse
        - int_dt3dt_sw_coarse
        - tsfc_coarse
        - uflx_coarse
        - vflx_coarse
    args:
      urlpath: "gs://vcm-ml-intermediate/2020-05-coarsen-c384-diagnostics/coarsen_diagnostics/gfsphysics_15min_coarse.zarr"
      consolidated: True

  40day_c48_column_nudging_may2020:
    description: Column-integrated nudging tendencies from 40-day nudged simulation (May 27 2020 SHiELD), coarsened to C48 resolution.
    driver: zarr
    metadata:
      grid: c48
      simulation: 40day_may2020
      category: physics
      variables:
        - int_t_dt_nudge_coarse
        - int_u_dt_nudge_coarse
        - int_v_dt_nudge_coarse
    args:
      urlpath: "gs://vcm-ml-intermediate/2021-05-26-coarsened-fine-res-diagnostics/atmos_15min_coarse_ave.zarr"
      consolidated: True

  40day_c48_pressure_interpolated_may2020:
    description: >-
      3D dynamical core diagnostics variables from 40-day nudged simulation (May 27 2020 SHiELD), coarsened to C48 resolution and interpolated to pressure levels. 
      Generated with https://github.com/VulcanClimateModeling/explore/blob/master/annak/2021-03-23-save-c3072-verification.ipynb
    driver: zarr
    metadata:
      grid: c48
      simulation: 40day_may2020
      category: 3d
      variables:
        - air_temperature
        - specific_humidity
        - eastward_wind
        - northward_wind
        - vertical_wind
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-intermediate/2020-05-coarsen-c384-diagnostics/coarsen_diagnostics/pressure-interpolated.zarr"
      consolidated: True
      
  40day_c48_restarts_as_zarr_may2020:
    description: >-
      Restart files at C48 resolution every 15 minutes, consolidated as a zarr store.
      Created using `fv3net.pipelines.restarts_to_zarr`.
    driver: zarr
    metadata:
      grid: c48
      simulation: 40day_may2020
      category: 3d
      variables:
        - DZ
        - T
        - W
        - alnsf
        - alnwf
        - alvsf
        - alvwf
        - canopy
        - cld_amt
        - delp
        - f10m
        - facsf
        - facwf
        - ffhh
        - ffmm
        - fice
        - graupel
        - hice
        - ice_wat
        - liq_wat
        - o3mr
        - phis
        - q2m
        - rainwat
        - sgs_tke
        - shdmax
        - shdmin
        - sheleg
        - slc
        - slmsk
        - slope
        - smc
        - sncovr
        - snoalb
        - snowwat
        - snwdph
        - sphum
        - srflag
        - stc
        - stype
        - t2m
        - tg3
        - tisfc
        - tprcp
        - tsea
        - u
        - u_srf
        - uustar
        - v
        - v_srf
        - vfrac
        - vtype
        - zorl
    args:
      urlpath: "gs://vcm-ml-intermediate/2021-06-SHiELD-40-day-restarts-as-zarr/C48_restarts.zarr"
      consolidated: True

  40day_c48_atmos_8xdaily_may2020:
    description: 2D dynamical core diagnostics variables from 40-day nudged simulation (May 27 2020 SHiELD), coarsened to C48 resolution.
    driver: zarr
    metadata:
      grid: c48
      simulation: 40day_may2020
      category: dycore
      variables:
        - PRESctp
        - PRESsfc
        - PRMSL
        - PWAT
        - REFC
        - TB
        - TMP500_300
        - UGRDlowest
        - VGRDlowest
        - VIL
        - VORT200
        - VORT500
        - VORT850
        - VVEL5km
        - h500
        - iw
        - u200
        - v200
        - w500
    args:
      urlpath: "gs://vcm-ml-intermediate/2020-05-coarsen-c384-diagnostics/coarsen_diagnostics/atmos_8xdaily_C3072_to_C384.zarr"
      consolidated: True

  40day_c48_atmos_8xdaily_additional_vars_may2020:
    description: >-
      Additional pressure level 2D dynamical core diagnostics variables from 40-day nudged simulation (May 27 2020 SHiELD), coarsened to C48 resolution.
      Generated with https://github.com/VulcanClimateModeling/explore/blob/master/annak/2021-03-23-save-c3072-2d-vars.ipynb
    driver: zarr
    metadata:
      grid: c48
      simulation: 40day_may2020
      category: dycore
      variables:
        - q1000
        - q850
        - q500
        - TMP850
        - TMP500
        - TMP200
        - UGRD850
        - UGRD200
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-intermediate/2020-05-coarsen-c384-diagnostics/coarsen_diagnostics/atmos_8xdaily_add_vars_corrected_wind.zarr"
      consolidated: True

  GFS_analysis_T85_2015_2016:
    description: 4x daily GFS analysis data at approximately 2deg resolution, typically used for nudging FV3GFS. Spans 2015-01-01T00:00:00 to 2017-01-01T00:00:00.
    driver: zarr
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-intermediate/2020-03-27-T85-GFS-nudging-data-as-zarr/nudging_data_2015-2016.zarr"

  GFS_analysis_T85_2015_2016_1M_mean:
    description: Monthly mean GFS analysis data at approximately 2deg resolution. Spans 2015-01 to 2016-12.
    driver: zarr
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-intermediate/2020-03-27-T85-GFS-nudging-data-as-zarr/nudging_data_mean_1M.zarr"

  grid/c48:
    description: Lat, lon, and area of C48 data
    driver: zarr
    metadata:
      grid: c48
      variables:
        - area
        - lat
        - latb
        - lon
        - lonb
    args:
      urlpath: "gs://vcm-ml-intermediate/latLonArea/c48/c48.zarr/"
      consolidated: true

  landseamask/c48:
    description: land_sea_mask of C48 data
    driver: zarr
    metadata:
      grid: c48
      variables:
        - land_sea_mask
    args:
      urlpath: "gs://vcm-ml-intermediate/latLonArea/c48/land_sea_mask.zarr/"
      consolidated: true

  wind_rotation/c48:
    description: Rotation matrix components transforming x/y components to lat/lon 
    driver: zarr
    metadata:
      grid: c48
      variables:
        - eastward_wind_u_coeff
        - eastward_wind_v_coeff
        - northward_wind_u_coeff
        - northward_wind_v_coeff
        - x_unit_vector
        - y_unit_vector
        - lat_unit_vector
        - lon_unit_vector
    args:
      urlpath: "gs://vcm-ml-intermediate/latLonArea/c48/wind_rotation_matrix_correct_factor.zarr/"
      consolidated: true


  grid/c96:
    description: C96 grid spec (area, lat, lon, latb, lonb)
    driver: zarr
    metadata:
      grid: c96
      variables:
        - area
        - lat
        - latb
        - lon
        - lonb
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-intermediate/latLonArea/c96/grid_spec.zarr/"
      consolidated: true

  landseamask/c96:
    description: snapshot of land_sea_mask of C96 data on 1 August
    driver: zarr
    metadata:
      grid: c96
      variables:
        - land_sea_mask
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-intermediate/latLonArea/c96/land_sea_mask.zarr"
      consolidated: true

  wind_rotation/c96:
    description: Rotation matrix components transforming x/y components to lat/lon
    driver: zarr
    metadata:
      grid: c96
      variables:
        - eastward_wind_u_coeff
        - eastward_wind_v_coeff
        - northward_wind_u_coeff
        - northward_wind_v_coeff
        - x_unit_vector
        - y_unit_vector
        - lat_unit_vector
        - lon_unit_vector
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-intermediate/latLonArea/c96/wind_rotation_matrix_correct_factor.zarr"
      consolidated: true

  grid/c384:
    description: C384 grid spec (area, lat, lon, latb, lonb)
    driver: zarr
    metadata:
      grid: c384
      variables:
        - area
        - lat
        - latb
        - lon
        - lonb
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-intermediate/latLonArea/c384/grid_spec.zarr"
      consolidated: true

  landseamask/c384:
    description: snapshot of land_sea_mask of C384 data on 1 August
    driver: zarr
    metadata:
      grid: c384
      variables:
        - land_sea_mask
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-intermediate/latLonArea/c384/land_sea_mask.zarr"
      consolidated: true

  2016_c48_nudged_fv3gfs_physics_output:
    description: 2D physics diagnostics variables from 2016 nudged-to-obs FV3GFS simulation (Sept 30, 2020)
    driver: zarr
    args:
      metadata:
        grid: c48
        simulation: nudged_c48_fv3gfs_2016
        category: physics
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-experiments/2020-09-30-nudge-to-obs-year-long-training-run/physics_output.zarr"
      consolidated: True

  2016_c48_nudged_fv3gfs_dycore_output:
    description: 2D dynamical core diagnostics variables from 2016 nudged-to-obs FV3GFS simulation (Sept 30, 2020)
    driver: zarr
    args:
      metadata:
        grid: c48
        simulation: nudged_c48_fv3gfs_2016
        category: dycore
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-experiments/2020-09-30-nudge-to-obs-year-long-training-run/atmos_output.zarr"
      consolidated: True

  2015_2016_c48_nudged_fv3gfs_physics_output:
    description: 2D physics diagnostics variables from 2015-2016 nudged-to-obs FV3GFS simulation (Nov 10, 2020)
    driver: zarr
    args:
      metadata:
        grid: c48
        simulation: nudged_c48_fv3gfs_2015_2016
        category: physics
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-experiments/2020-10-30-nudge-to-obs-GRL-paper/nudge-to-obs-run-3hr-diags/physics_output.zarr"
      consolidated: True

  2015_2016_c48_nudged_fv3gfs_dycore_output:
    description: 2D dynamical core diagnostics variables from 2016 nudged-to-obs FV3GFS simulation (Nov 10, 2020)
    driver: zarr
    args:
      metadata:
        grid: c48
        simulation: nudged_c48_fv3gfs_2015_2016
        category: dycore
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-experiments/2020-10-30-nudge-to-obs-GRL-paper/nudge-to-obs-run-3hr-diags/atmos_output.zarr"
      consolidated: True

  2020-11-10-C3072-to-C384-exposed-area:
    description: "grid file with exposed_area variable. From a one-off run performed by Spencer Clark."
    driver: zarr
    args:
      metadata:
        grid: c384
      storage_options:
        project: vcm-ml
        access: read_only
      urlpath: gs://vcm-ml-raw/2020-11-10-C3072-to-C384-exposed-area.zarr
      consolidated: true

  free_minus_4K_ssts_c384_fv3gfs_20170801_20190801_physics_output:
    description: 2D physics diagnostics variables from two-year free-running C384 FV3GFS simulation with minus 4K SSTs (January 9, 2021)
    driver: zarr
    args:
      metadata:
        grid: c48
        simulation: free_minus_4K_ssts_c384_fv3gfs_20170801_20190801
        category: physics
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-raw-flexible-retention/2021-01-04-1-year-C384-FV3GFS-simulations/minus-4K/C384-to-C48-diagnostics/gfsphysics_15min_coarse.zarr"
      consolidated: True

  free_minus_4K_ssts_c384_fv3gfs_20170801_20190801_dycore_output:
    description: 2D dynamical core diagnostics variables from two-year free-running C384 FV3GFS simulation with minus 4K SSTs (January 9, 2021)
    driver: zarr
    args:
      metadata:
        grid: c48
        simulation: free_minus_4K_ssts_c384_fv3gfs_20170801_20190801
        category: dycore
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-raw-flexible-retention/2021-01-04-1-year-C384-FV3GFS-simulations/minus-4K/C384-to-C48-diagnostics/atmos_8xdaily_coarse_interpolated.zarr"
      consolidated: True

  free_unperturbed_ssts_c384_fv3gfs_20170801_20190801_physics_output:
    description: 2D physics diagnostics variables from two-year free-running C384 FV3GFS simulation with unperturbed SSTs (January 9, 2021)
    driver: zarr
    args:
      metadata:
        grid: c48
        simulation: free_unperturbed_ssts_c384_fv3gfs_20170801_20190801
        category: physics
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-raw-flexible-retention/2021-01-04-1-year-C384-FV3GFS-simulations/unperturbed/C384-to-C48-diagnostics/gfsphysics_15min_coarse.zarr"
      consolidated: True

  free_unperturbed_ssts_c384_fv3gfs_20170801_20190801_dycore_output:
    description: 2D dynamical core diagnostics variables from two-year free-running C384 FV3GFS simulation with unperturbed SSTs (January 9, 2021)
    driver: zarr
    args:
      metadata:
        grid: c48
        simulation: free_unperturbed_ssts_c384_fv3gfs_20170801_20190801
        category: dycore
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-raw-flexible-retention/2021-01-04-1-year-C384-FV3GFS-simulations/unperturbed/C384-to-C48-diagnostics/atmos_8xdaily_coarse_interpolated.zarr"
      consolidated: True

  free_unperturbed_ssts_c384_fv3gfs_20170801_20190801_pressure_interpolated_output:
    description: >-
      3D pressure interpolated dynamical core diagnostics variables from two-year free-running C384 FV3GFS simulation with unperturbed SSTs (January 9, 2021)
      Generated with https://github.com/VulcanClimateModeling/explore/blob/master/annak/2021-03-04-save-c384-3d-verif/save_verification.py
    driver: zarr
    args:
      metadata:
        grid: c48
        simulation: free_unperturbed_ssts_c384_fv3gfs_20170801_20190801
        category: 3d
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-raw-flexible-retention/2021-01-04-1-year-C384-FV3GFS-simulations/unperturbed/C384-to-C48-diagnostics/pressure-interpolated.zarr"
      consolidated: True


  free_plus_4K_ssts_c384_fv3gfs_20170801_20190801_physics_output:
    description: 2D physics diagnostics variables from two-year free-running C384 FV3GFS simulation with plus 4K SSTs (January 9, 2021)
    driver: zarr
    args:
      metadata:
        grid: c48
        simulation: free_plus_4K_ssts_c384_fv3gfs_20170801_20190801
        category: physics
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-raw-flexible-retention/2021-01-04-1-year-C384-FV3GFS-simulations/plus-4K/C384-to-C48-diagnostics/gfsphysics_15min_coarse.zarr"
      consolidated: True

  free_plus_4K_ssts_c384_fv3gfs_20170801_20190801_dycore_output:
    description: 2D dynamical core diagnostics variables from two-year free-running C384 FV3GFS simulation with plus 4K SSTs (January 9, 2021)
    driver: zarr
    args:
      metadata:
        grid: c48
        simulation: free_plus_4K_ssts_c384_fv3gfs_20170801_20190801
        category: dycore
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-raw-flexible-retention/2021-01-04-1-year-C384-FV3GFS-simulations/plus-4K/C384-to-C48-diagnostics/atmos_8xdaily_coarse_interpolated.zarr"
      consolidated: True

  free_plus_4K_ssts_c384_fv3gfs_20170801_20190801_pressure_interpolated_output:
    description: >-
      3D pressure interpolated dynamical core diagnostics variables from two-year free-running C384 FV3GFS simulation with plus 4K SSTs (January 9, 2021)
      Generated with https://github.com/VulcanClimateModeling/explore/blob/master/annak/2021-03-04-save-c384-3d-verif/save_verification.py
    driver: zarr
    args:
      metadata:
        grid: c48
        simulation: free_plus_4K_ssts_c384_fv3gfs_20170801_20190801
        category: 3d
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-raw-flexible-retention/2021-01-04-1-year-C384-FV3GFS-simulations/plus-4K/C384-to-C48-diagnostics/pressure-interpolated.zarr"
      consolidated: True

  # Regression testing data. Do not use for analysis, values are randomized.
  grid/c8_random_values:
    description: FOR REGRESSION TESTING ONLY. Lat, lon, and area of C48 data
    driver: zarr
    metadata:
      grid: c8
      variables:
        - area
        - lat
        - latb
        - lon
        - lonb
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-code-testing-data/c8-grids-regression-testing/grid.zarr/"
      consolidated: true

  wind_rotation/c8_random_values:
    description: FOR REGRESSION TESTING ONLY. 
      Rotation matrix components transforming x/y components to lat/lon 
    driver: zarr
    metadata:
      grid: c8
      variables:
        - eastward_wind_u_coeff
        - eastward_wind_v_coeff
        - northward_wind_u_coeff
        - northward_wind_v_coeff
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-code-testing-data/c8-grids-regression-testing/wind_rotation.zarr/"
      consolidated: true

  landseamask/c8_random_values:
    description: FOR REGRESSION TESTING ONLY. land_sea_mask of C8 data
    driver: zarr
    metadata:
      grid: c8
      variables:
        - land_sea_mask
    args:
      storage_options:
        project: 'vcm-ml'
        access: read_only
      urlpath: "gs://vcm-ml-code-testing-data/c8-grids-regression-testing/landseamask.zarr/"
      consolidated: true
