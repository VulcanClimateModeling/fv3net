random_seed: 0
model_type: dense
hyperparameters:
  loss:
    loss_type: mse
    scaling: standard
  dense_network:
    depth: 4
    width: 169
    kernel_regularizer:
      name: l2
      kwargs:
        l: 0.0005
  training_loop:
    batch_size: 2048
    epochs: 50
    in_memory: false
    shuffle_buffer_size: 50000
  output_limit_config:
    limits:
      cloud_amount: {min: 0.0, max: 1.0}
      cloud_ice_mixing_ratio: {min: 0.0}
      cloud_water_mixing_ratio: {min: 0.0}
  optimizer_config:
    name: Adam
    kwargs:
      learning_rate: 0.0005
  callbacks:
    - kwargs: {}
      name: WandbCallback
    - kwargs:
        monitor: val_loss
        patience: 25
      name: EarlyStopping
    - name: EpochModelCheckpoint
      kwargs:
        filepath: gs://vcm-ml-experiments/cloud-ml/2023-05-02/trained_models_by_epoch/dense-local-v2-small/{epoch}
  input_variables:
    - pressure
    - relative_humidity
    - air_temperature
    - cloud_ice_mixing_ratio_coarse
  output_variables:
    - cloud_ice_mixing_ratio
    - cloud_water_mixing_ratio
    - cloud_amount