model_type: cyclegan
cache:
  in_memory: false
random_seed: 0
hyperparameters:
  state_variables:
    - PRATEsfc
    # - TMPlowest
    # - h500
    # - PRESsfc
    # - w500
    # - TMP500_300
    # - PWAT
  normalization_fit_samples: 50_000
  network:
    convolution_type: halo_conv2d
    optimizer:
      name: Adam
      kwargs:
        lr: 6.31051293e-7
    generator:
      n_convolutions: 2
      n_resnet: 6
      kernel_size: 3
      strided_kernel_size: 3
      max_filters: 512
      use_geographic_bias: false
      use_geographic_embedded_bias: false
      use_geographic_features: true
    discriminator:
      n_convolutions: 3
      kernel_size: 3
      strided_kernel_size: 4
      max_filters: 1024
      use_geographic_embedded_bias: false
      use_geographic_features: true
    identity_loss:
      loss_type: mae
    cycle_loss:
      loss_type: mae
    gan_loss:
      loss_type: mse
    identity_weight: 0.5
    cycle_weight: 10.0
    generator_weight: 1.0
    discriminator_weight: 1.0
  reload_path: gs://vcm-ml-experiments/cyclegan/checkpoints/c48_to_c384/20230329-221950-bbc73854-epoch_023/
  training:
    n_epoch: 100
    in_memory: false
    shuffle_buffer_size: 1000
    samples_per_batch: 1
    checkpoint_path: gs://vcm-ml-experiments/cyclegan/checkpoints/c48_to_c384/
    scheduler:
      name: ExponentialLR
      kwargs:
        gamma: 0.79433
        last_epoch: -1
