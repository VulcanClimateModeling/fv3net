root: gs://vcm-ml-scratch/annak/2020-08-17-hybrid-nudge-to-obs/iter-1
public-report-output: gs://vcm-ml-public/annak/2020-08-20-test-argo-templates
image-tag: b9aa2addafe8d601fb099a60ef4146e3107f0afb
training-input: "notused"
initial-condition: "20160801.001500"
store-true-args: "--nudge-to-observations"
reference-restarts: gs://vcm-ml-experiments/2020-06-02-fine-res/coarsen_restarts
training-config: | 
  model_type: sklearn_random_forest
  hyperparameters:
    max_depth: 13
    n_estimators: 1
  input_variables:
    - air_temperature
    - specific_humidity
  output_variables:
    - dQ1
    - dQ2
  batch_function: batches_from_geodata
  batch_kwargs:
    timesteps_per_batch: 10
    mapping_function: open_fine_resolution_nudging_to_obs_hybrid
    mapping_kwargs:
      fine_res_kwargs:
        fine_res_url: gs://vcm-ml-experiments/2020-07-30-fine-res
        offset_seconds: 450
        rename_vars:
          grid_xt: x
          grid_yt: y
          grid_x: x_interface
          grid_y: y_interface
          delp: pressure_thickness_of_atmospheric_layer
          pfull: z
      prog_nudge_kwargs:
        url: gs://vcm-ml-experiments/2020-08-17-hybrid-nudge-to-obs/initial-run/prognostic_run/
train-times: |
  # inserted from json file when submitted from Makefile
test-times: |
  # inserted from json file when submitted from Makefile
prognostic-run-config: |
  kubernetes:
    memory: 10Gi
    cpu: 6
  scikit_learn:
    physics_tendency_vars: 
      - air_temperature
      - specific_humidity
  diagnostics:
    -
      name: data.zarr
      times:
        frequency: 7200
        kind: interval
      variables:
        - tendency_of_air_temperature_due_to_fv3_physics
        - tendency_of_specific_humidity_due_to_fv3_physics
        - air_temperature
        - specific_humidity
  diag_table: /fv3net/workflows/prognostic_c48_run/nudge_to_obs/diag_table_nudge_to_obs
  base_version: v0.5
  namelist:
    coupler_nml:
      days: 40
      hours: 0
      minutes: 0
    fv_core_nml:
      nudge: true
      do_sat_adj: false
    gfdl_cloud_microphysics_nml:
      fast_sat_adj: false
    gfs_physics_nml:
      do_deep: false
      do_gfdl_mp_in_physics: false
      do_only_clearsky_rad: true
      shal_cnv: false
    fv_nwp_nudge_nml:
        nudge_hght: false
        nudge_ps: true
        nudge_virt: true
        nudge_winds: true
        nudge_q: true
        tau_ps: 21600.0
        tau_virt: 21600.0
        tau_winds: 21600.0
        tau_q: 21600.0
offline-diags-config: |
  data_path: notusedforthismapper
  variables:
    - air_temperature
    - specific_humidity
    - dQ1
    - dQ2
    - pQ1
    - pQ2
    - pressure_thickness_of_atmospheric_layer
  mapping_function: open_fine_resolution_nudging_hybrid
  mapping_kwargs:
    nudging:
      nudging_url: gs://vcm-ml-experiments/2020-06-17-triad-round-1/nudging/nudging/outdir-3h
      open_checkpoints_kwargs:
        checkpoint_files:
          - after_dynamics.zarr
          - after_physics.zarr
    fine_res:
      fine_res_url: gs://vcm-ml-experiments/2020-07-30-fine-res
      offset_seconds: 450
      rename_vars:
        grid_xt: x
        grid_yt: y
        delp: pressure_thickness_of_atmospheric_layer
        pfull: z
  batch_kwargs:
    timesteps_per_batch: 10
