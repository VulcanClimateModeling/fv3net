# train-data: gs://vcm-ml-experiments/2020-08-10-emulation/turb_data_20day_5minout/
train-data: gs://vcm-ml-experiments/2020-12-17-20day_turb_training_callpyfort/state_output.zarr/
model-output: gs://vcm-ml-scratch/andrep/emulation-models/2021-01-04-rtg-fixed/
report-output: gs://vcm-ml-public/andrep/emulation-diags/2021-01-04-rtg-fixed/
num-test-batches: 192
report-image: us.gcr.io/vcm-ml/emulation_report:build-2021-01-01
emulation-image: us.gcr.io/vcm-ml/fv3fit:emulation-2021-01-01
is-classifier: false
train-config: |
  model_type: DenseWithClassifier
  input_variables: [
    "tdt_input",
    "u1_input",
    "v1_input",
    "q1_input_0",
    "q1_input_1",
    "q1_input_2",
    "q1_input_3",
    "q1_input_4",
    "q1_input_5",
    "q1_input_6",
    "q1_input_7",
    "swh_input",
    "hlw_input",
    "xmu_input",
    # "psk_input",
    "rbsoil_input",
    "zorl_input",
    "u10m_input",
    "v10m_input",
    "fm_input",
    "fh_input",
    "tsea_input",
    "heat_input",
    "evap_input",
    "stress_input",
    "spd1_input",
    "prsl_input",
    "prslk_input",
    "phii_input",
    "phil_input",
    "t1_input",
  ]
  output_variables: [
    dqsfc_output,
    dtsfc_output,
    dvsfc_output,
    dusfc_output,
    du_output,
    dv_output,
    tdt_update,
    hpbl_output,
    kpbl_output,
    "rtg_output_0",
    # "rtg_output_1",
    # "rtg_output_2",
    # "rtg_output_3",
    # "rtg_output_4",
    # "rtg_output_5",
    # "rtg_output_6",
    # "rtg_output_7",
  ]
  batch_function: null
  batch_kwargs:
    train_range: [96, 960]
    seed: 104
  hyperparameters:
    depth: 2
    width: 128
    normalize_loss: True
    optimizer: Adam
    learning_rate: exponential
    # weights:
    #   du_output: rms
    #   dv_output: rms
    #   tdt_update: rms
    mask_with_classifier: [
      du_output,
      dv_output,
      tdt_update,
      rtg_output_0,
    ]
    classifiers:
      dv_output: gs://vcm-ml-scratch/andrep/classifier-models/2020-12-30-dv_output-classifier/keras_model
      du_output: gs://vcm-ml-scratch/andrep/classifier-models/2020-12-30-du_output-classifier/keras_model
      tdt_update : gs://vcm-ml-scratch/andrep/classifier-models/2020-12-30-tdt_update-classifier/keras_model
    limit_zero: [hpbl_output, kpbl_output]
    fit_kwargs:
      epochs: 2
      workers: 4
      max_queue_size: 8
      batch_size: 32
      verbose: 2