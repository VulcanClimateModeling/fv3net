storage_proto: gs
storage_root: vcm-ml-experiments/2020-07-14-nudge-to-obs
experiment:
  name: $JOBNAME
  unique_id: false
  steps_to_run:
    - train_sklearn_model
    - prognostic_run
    - long_prognostic_run
    - long_baseline_run

  steps_config:

    train_sklearn_model:
      command: python -m fv3net.regression.sklearn
      args:
        training_data:
          location: gs://vcm-ml-scratch/oliwm/nudge-to-obs-40day
        train-config-file: $CONFIG/train_sklearn.yaml
        --no-train-subdir-append: ""
        --timesteps-file: $CONFIG/training_times.json

    prognostic_run:
      command: python workflows/prognostic_c48_run/orchestrate_submit_job.py
      args:
        restart_data:
          location: $C48_RESTARTS
        ic_timestep: $IC_TIMESTEP
        --image-tag: $TAG
        --prog_config_yml: $CONFIG/prognostic_run.yaml
        --detach: ''
        --model_url:
          from: train_sklearn_model

    long_prognostic_run:
      command: python workflows/prognostic_c48_run/orchestrate_submit_job.py
      args:
        restart_data:
          location: $C48_RESTARTS
        ic_timestep: $IC_TIMESTEP
        --image-tag: $TAG
        --prog_config_yml: $CONFIG/long_prognostic_run.yaml
        --detach: ''
        --model_url:
          from: train_sklearn_model

    long_baseline_run:
      command: python workflows/prognostic_c48_run/orchestrate_submit_job.py
      args:
        restart_data:
          location: $C48_RESTARTS
        ic_timestep: $IC_TIMESTEP
        --image-tag: $TAG
        --prog_config_yml: $CONFIG/long_prognostic_run.yaml
        --diagnostic_ml: ''
        --model_url:
          from: train_sklearn_model