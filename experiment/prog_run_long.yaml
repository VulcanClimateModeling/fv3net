apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: hybrid-40-day-
spec:
  serviceAccountName: integration-tests
  tolerations:
    - effect: NoSchedule
      key: dedicated
      value: climate-sim-pool
  entrypoint: main
  arguments:
    parameters:
      - name: input-variables
        value: |
          ["specific_humidity", "air_temperature"]
  volumes:
    - name: gcp-key-secret
      secret:
        defaultMode: 420
        secretName: gcp-key
  templates:
  - name: main
    dag:
      tasks:
      - name: prognostic-run
        templateRef:
          name: prognostic-run
          template: prognostic-run
        arguments:
          parameters:
              - name: image-tag
                value: "{{workflow.parameters.image-tag}}"
              - name: initial-condition
                value: "{{workflow.parameters.initial-condition}}"
              - name: config
                value: "{{workflow.parameters.prognostic-run-config}}"
              - name: reference-restarts
                value: "{{workflow.parameters.reference-restarts}}"
              - name: trained-ml
                value: "{{workflow.parameters.trained-model}}"
              - name: output
                value: "{{workflow.parameters.root}}/{{workflow.name}}/prognostic_run"
